# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 500 Server Error –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

## üìå –°–∏–º–ø—Ç–æ–º—ã
- –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ `/admin` –∏–ª–∏ `/login` –ø–æ—è–≤–ª—è–µ—Ç—Å—è –±–µ–ª–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ **500 Server Error**
- –í –ª–æ–≥–∞—Ö Laravel —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –æ—à–∏–±–∫–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/–∫–ª—é—á–∞ –∏–ª–∏ –∑–∞–ø–∏—Å–∏ –≤ `storage`

## ‚ö° –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–∑–∞–∫—Ä—ã–≤–∞–µ—Ç 90% —Å–ª—É—á–∞–µ–≤)
```bash
cd /var/www/iiko-base/frontend

# 1) –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å .env –∏ APP_KEY
[ -f .env ] || cp .env.example .env
php artisan key:generate --force

# 2) –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à–∏ –∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
php artisan optimize:clear
php artisan config:cache

# 3) –ü–æ—á–∏–Ω–∏—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ Laravel
sudo chown -R www-data:www-data storage bootstrap/cache
sudo chmod -R 775 storage bootstrap/cache

# 4) –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ PHP-FPM –∏ Nginx
sudo systemctl restart php8.3-fpm || sudo systemctl restart php-fpm
sudo systemctl restart nginx
```

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º –æ–∫–Ω–µ –±—Ä–∞—É–∑–µ—Ä–∞. –ï—Å–ª–∏ 500 –∏—Å—á–µ–∑–ª–∞ ‚Äî –ø—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ –∫–ª—é—á–µ/–∫—ç—à–µ –∏–ª–∏ –ø—Ä–∞–≤–∞—Ö.

## üîç –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –æ—à–∏–±–∫–∏ 500 –≤ –∞–¥–º–∏–Ω–∫–µ
1. **–ù–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω APP_KEY** ‚Äì Laravel –Ω–µ –º–æ–∂–µ—Ç —à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å–µ—Å—Å–∏—é –∏ –ø–∞–¥–∞–µ—Ç —Å 500
2. **–ù–µ–≤–µ—Ä–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ `storage` –∏–ª–∏ `bootstrap/cache`** ‚Äì —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –Ω–µ –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å –ª–æ–≥–∏/–∫—ç—à
3. **–£—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫—ç—à –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** ‚Äì –ø–æ—Å–ª–µ –ø—Ä–∞–≤–æ–∫ `.env` –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã `config:clear`
4. **–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î** ‚Äì –Ω–µ–≤–µ—Ä–Ω—ã–µ `DB_*` –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω PostgreSQL
5. **–ù–µ –∑–∞–ø—É—â–µ–Ω PHP-FPM** ‚Äì Nginx –æ—Ç–¥–∞—ë—Ç 500 –≤–º–µ—Å—Ç–æ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –≤ PHP

## üõ†Ô∏è –ü–æ—à–∞–≥–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
1. **–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ Laravel**
   ```bash
   tail -50 storage/logs/laravel.log
   ```
   - `No application encryption key has been specified` ‚Üí –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `php artisan key:generate`
   - `Permission denied` ‚Üí –∏—Å–ø—Ä–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ `storage` –∏ `bootstrap/cache`

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ APP_KEY**
   ```bash
   grep ^APP_KEY .env || echo "APP_KEY –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
   ```
   –ï—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –±–ª–æ–∫ ¬´–ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ¬ª.

3. **–û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à–∏ –ø–æ—Å–ª–µ –ø—Ä–∞–≤–æ–∫ `.env`**
   ```bash
   php artisan optimize:clear
   php artisan config:cache
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ frontend/.env: DB_HOST, DB_PORT, DB_DATABASE, DB_USERNAME, DB_PASSWORD
   php artisan migrate:status
   ```
   –ï—Å–ª–∏ –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—à–∏–±–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ PostgreSQL:
   ```bash
   sudo systemctl status postgresql
   ```

5. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PHP-FPM —Ä–∞–±–æ—Ç–∞–µ—Ç**
   ```bash
   sudo systemctl status php8.3-fpm || sudo systemctl status php-fpm
   sudo systemctl restart php8.3-fpm || sudo systemctl restart php-fpm
   ```

6. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏ Nginx (–µ—Å–ª–∏ 500 –æ—Ç–¥–∞—ë—Ç —Å–∞–º Nginx)**
   ```bash
   sudo tail -50 /var/log/nginx/iiko-base-error.log
   sudo tail -50 /var/log/nginx/error.log
   ```

## ‚úÖ –ö–∞–∫ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞
- –ó–∞–ø—Ä–æ—Å `curl -I https://–≤–∞—à-–¥–æ–º–µ–Ω/admin` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `302 Found` (—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ª–æ–≥–∏–Ω)
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–æ–≥–∏–Ω–∞ –≥—Ä—É–∑–∏—Ç—Å—è –±–µ–∑ 500, –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ñ–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –í `storage/logs/laravel.log` –Ω–µ—Ç –Ω–æ–≤—ã—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã

> üí° –ï—Å–ª–∏ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∞–≥–æ–≤ –æ—à–∏–±–∫–∞ –æ—Å—Ç–∞—ë—Ç—Å—è, –≤–∫–ª—é—á–∏—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω–æ `APP_DEBUG=true` –≤ `frontend/.env`, –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ `php artisan optimize:clear`, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–∏—Ç–µ 500, –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ `storage/logs/laravel.log`, –∑–∞—Ç–µ–º –≤–µ—Ä–Ω–∏—Ç–µ `APP_DEBUG=false`.
