# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å - –ò—Ç–æ–≥–æ–≤–∞—è –°–≤–æ–¥–∫–∞

## ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ –†–µ—à–µ–Ω–∞

–í—ã —Å–æ–æ–±—â–∏–ª–∏:
> "–î–∞–∂–µ –ø–æ—Å–ª–µ –≤—Å–µ—Ö —Å–±—Ä–æ—Å–æ–≤ –ø–∞—Ä–æ–ª—è –ø–∏—à–µ—Ç: –ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É."

**–†–µ—à–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

---

## üéØ –ß—Ç–æ –ë—ã–ª–æ –°–¥–µ–ª–∞–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –°–∫—Ä–∏–ø—Ç ‚≠ê

**–§–∞–π–ª:** `scripts/diagnose_and_fix_admin.sh`

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ 10 –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω –ø—Ä–æ–±–ª–µ–º—ã
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –±–µ–∑ –≤–∞—à–µ–≥–æ —É—á–∞—Å—Ç–∏—è
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç —Å —Ü–≤–µ—Ç–Ω—ã–º–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã (–±–µ–∑ SQL-–∏–Ω—ä–µ–∫—Ü–∏–π)

**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:**
1. PostgreSQL –∑–∞–ø—É—â–µ–Ω
2. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç
3. –¢–∞–±–ª–∏—Ü–∞ `users` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
4. **–ö–æ–ª–æ–Ω–∫–∞ `role` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç** (—Å–∞–º–∞—è —á–∞—Å—Ç–∞—è –ø—Ä–æ–±–ª–µ–º–∞!)
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `admin` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
6. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `admin` –∞–∫—Ç–∏–≤–µ–Ω
7. –•–µ—à –ø–∞—Ä–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (–±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤)
8. Backend —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω
9. API —ç–Ω–¥–ø–æ–∏–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç
10. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã .env –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç:**
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â—É—é –∫–æ–ª–æ–Ω–∫—É `role` –≤ —Ç–∞–±–ª–∏—Ü–µ users
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è admin
- –ù–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è admin
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ö–µ—à –ø–∞—Ä–æ–ª—è (—Å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏)

### 2. –°–æ–∑–¥–∞–Ω–∞ –ü–æ–¥—Ä–æ–±–Ω–∞—è –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### –ù–∞ –†—É—Å—Å–∫–æ–º:
- **`–ü–û–õ–ù–û–ï_–†–ï–®–ï–ù–ò–ï_–í–•–û–î–ê_–í_–ê–î–ú–ò–ù–ö–£.md`** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Å —Ä–µ—à–µ–Ω–∏–µ–º –≤—Å–µ—Ö 10 –ø—Ä–æ–±–ª–µ–º
- **`–ë–´–°–¢–†–ê–Ø_–ü–û–ú–û–©–¨_–í–•–û–î_–í_–ê–î–ú–ò–ù–ö–£.md`** - –ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–æ—á–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞

#### –ù–∞ –ê–Ω–≥–ª–∏–π—Å–∫–æ–º:
- **`ADMIN_LOGIN_QUICK_FIX.md`** - Quick reference guide

### 3. –û–±–Ω–æ–≤–ª–µ–Ω README.md

–î–æ–±–∞–≤–ª–µ–Ω –∑–∞–º–µ—Ç–Ω—ã–π —Ä–∞–∑–¥–µ–ª —Å –±—ã—Å—Ç—Ä—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞.

---

## üöÄ –ö–∞–∫ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (3 –ø—Ä–æ—Å—Ç—ã—Ö —à–∞–≥–∞)

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É (30 —Å–µ–∫—É–Ω–¥)

```bash
cd /var/www/iiko-base  # –∏–ª–∏ –≤–∞—à–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞
./scripts/diagnose_and_fix_admin.sh
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç:
- –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ ‚úÖ
- –ß—Ç–æ –Ω–∞–π–¥–µ–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ ‚ùå
- –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚úÖ

### –®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend (–µ—Å–ª–∏ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

```bash
# –î–ª—è systemd:
sudo systemctl restart iiko-backend

# –î–ª—è Docker:
docker-compose restart backend
```

### –®–∞–≥ 3: –í–æ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω–∫—É

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://–≤–∞—à-–¥–æ–º–µ–Ω/login`

- **–õ–æ–≥–∏–Ω:** `admin`
- **–ü–∞—Ä–æ–ª—å:** `12101991Qq!`

üî¥ **–í–ê–ñ–ù–û:** –°—Ä–∞–∑—É —Å–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞!

---

## üîç –í—Å–µ –í–æ–∑–º–æ–∂–Ω—ã–µ –ü—Ä–∏—á–∏–Ω—ã –ü—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–∏—á–∏–Ω–∞ #1: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–ª–æ–Ω–∫–∞ `role` ‚≠ê –°–ê–ú–ê–Ø –ß–ê–°–¢–ê–Ø
**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –±—ã–ª–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
- –ë–∞–∑–∞ —Å–æ–∑–¥–∞–Ω–∞ –¥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —Ä–æ–ª–µ–π

**–ö–∞–∫ —Å–∫—Ä–∏–ø—Ç —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç:**
```sql
ALTER TABLE users ADD COLUMN IF NOT EXISTS role VARCHAR(20) DEFAULT 'viewer';
ALTER TABLE users ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT TRUE;
ALTER TABLE users ADD COLUMN IF NOT EXISTS is_superuser BOOLEAN DEFAULT FALSE;
```

### –ü—Ä–∏—á–∏–Ω–∞ #2: –ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è admin
**–ö–∞–∫ —Å–∫—Ä–∏–ø—Ç —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç:**
–°–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è admin —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ö–µ—à–µ–º –ø–∞—Ä–æ–ª—è.

### –ü—Ä–∏—á–∏–Ω–∞ #3: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ö–µ—à –ø–∞—Ä–æ–ª—è
**–°–∏–º–ø—Ç–æ–º—ã:**
- –•–µ—à –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `\$2b\$12\$` –≤–º–µ—Å—Ç–æ `$2b$12$`
- –•–µ—à –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –æ–∂–∏–¥–∞–µ–º—ã–º

**–ö–∞–∫ —Å–∫—Ä–∏–ø—Ç —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç:**
–û–±–Ω–æ–≤–ª—è–µ—Ç —Ö–µ—à –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π: `$2b$12$y4QVNPhuZfpLp1.xM6.NSeDnpD6I/wm.dSOXGrxV.HtXj6izHJLPa`

### –ü—Ä–∏—á–∏–Ω–∞ #4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å admin –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
**–ö–∞–∫ —Å–∫—Ä–∏–ø—Ç —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç:**
```sql
UPDATE users SET is_active = TRUE WHERE username = 'admin';
```

### –ü—Ä–∏—á–∏–Ω–∞ #5-10: –î—Ä—É–≥–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- Backend –Ω–µ –∑–∞–ø—É—â–µ–Ω ‚Üí –°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å
- PostgreSQL –Ω–µ –∑–∞–ø—É—â–µ–Ω ‚Üí –°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å
- API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç ‚Üí –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ .env —Ñ–∞–π–ª—ã ‚Üí –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

---

## üìä –ü—Ä–∏–º–µ—Ä –í—ã–≤–æ–¥–∞ –°–∫—Ä–∏–ø—Ç–∞

```
========================================
Admin Login Comprehensive Diagnostics
========================================

[1/10] Checking PostgreSQL service...
‚úì PostgreSQL is running

[2/10] Testing database connection...
‚úì Database connection successful

[3/10] Checking users table...
‚úì Users table exists

[4/10] Checking for role column...
‚úó Role column is MISSING (critical bug)
  This is a common cause of login failures!
  Attempting to fix...
‚úì Role column added successfully

[5/10] Checking admin user...
‚úì Admin user exists

[6/10] Checking admin is active...
‚úì Admin user is active

[7/10] Verifying password hash...
‚úì Password hash is correct

[8/10] Checking backend service...
‚úì Backend service is running (systemd)

[9/10] Testing API endpoint...
‚úì API login successful!

[10/10] Checking environment configuration...
‚úì Backend .env exists and configured
‚úì Frontend .env exists and configured

========================================
DIAGNOSTIC SUMMARY
========================================

‚úì All checks passed!

You should be able to login with:
  Username: admin
  Password: 12101991Qq!

‚ö†Ô∏è  IMPORTANT: Change this password immediately after login!

Applied 1 fix(es) automatically

Restart the backend service for changes to take effect:
  sudo systemctl restart iiko-backend
  OR: docker-compose restart backend
```

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
–í—Å–µ SQL –∑–∞–ø—Ä–æ—Å—ã –≤ —Å–∫—Ä–∏–ø—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã psql:
```bash
psql -v username="$ADMIN_USERNAME" "SELECT * FROM users WHERE username = :'username';"
```

### –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø–∞—Ä–æ–ª—è—Ö
–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø–∞—Ä–æ–ª–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
```
‚ö†Ô∏è  WARNING: Using default passwords!
   For production, set secure passwords via environment variables:
   export DB_PASSWORD='your_secure_password'
   export ADMIN_PASSWORD='your_secure_password'
```

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Å–∏—Å—Ç–µ–º
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
export DB_PASSWORD="–≤–∞—à_–Ω–∞–¥–µ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å"
export ADMIN_PASSWORD="–≤–∞—à_–Ω–∞–¥–µ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å"
./scripts/diagnose_and_fix_admin.sh
```

---

## üß™ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã (–±–µ–∑ Python)
```bash
./scripts/check_admin_db.sh
```

### –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è admin
```bash
./scripts/reset_admin_password.sh
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ API –Ω–∞–ø—Ä—è–º—É—é
```bash
curl -X POST http://localhost:8000/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"12101991Qq!"}'
```

–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
  "token_type": "bearer"
}
```

---

## üìù –§–∞–π–ª—ã –ò–∑–º–µ–Ω–µ–Ω—ã/–°–æ–∑–¥–∞–Ω—ã

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
1. ‚úÖ `scripts/diagnose_and_fix_admin.sh` - –ì–ª–∞–≤–Ω—ã–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç
2. ‚úÖ `–ü–û–õ–ù–û–ï_–†–ï–®–ï–ù–ò–ï_–í–•–û–î–ê_–í_–ê–î–ú–ò–ù–ö–£.md` - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ (RU)
3. ‚úÖ `–ë–´–°–¢–†–ê–Ø_–ü–û–ú–û–©–¨_–í–•–û–î_–í_–ê–î–ú–ò–ù–ö–£.md` - –ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ (RU)
4. ‚úÖ `ADMIN_LOGIN_QUICK_FIX.md` - Quick reference (EN)
5. ‚úÖ `–†–ï–®–ï–ù–ò–ï_–ü–†–û–ë–õ–ï–ú–´_–í–•–û–î–ê_–í_–ê–î–ú–ò–ù–ö–£_–ò–¢–û–ì.md` - –≠—Ç–æ—Ç —Ñ–∞–π–ª

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. ‚úÖ `README.md` - –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª —Å –±—ã—Å—Ç—Ä—ã–º —Ä–µ—à–µ–Ω–∏–µ–º

---

## üí° –¢–∞–±–ª–∏—Ü–∞ –ë—ã—Å—Ç—Ä–æ–≥–æ –†–µ—à–µ–Ω–∏—è

| –°–∏–º–ø—Ç–æ–º | –í–µ—Ä–æ—è—Ç–Ω–∞—è –ü—Ä–∏—á–∏–Ω–∞ | –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
|---------|-------------------|-------------------------|
| "–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ" | –õ—é–±–∞—è –∏–∑ 10 –ø—Ä–∏—á–∏–Ω | `./scripts/diagnose_and_fix_admin.sh` |
| "Connection refused" | Backend –Ω–µ –∑–∞–ø—É—â–µ–Ω | `sudo systemctl start iiko-backend` |
| 502 Bad Gateway | Nginx/Backend –ø—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ nginx |
| –ü—É—Å—Ç–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ | Frontend –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å frontend/.env |
| SQL –æ—à–∏–±–∫–∞ "role column" | –ù–µ—Ç –∫–æ–ª–æ–Ω–∫–∏ role | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º |

---

## üÜò –ï—Å–ª–∏ –í—Å—ë –ï—â—ë –ù–µ –†–∞–±–æ—Ç–∞–µ—Ç

### 1. –°–æ–±–µ—Ä–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

```bash
# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
./scripts/diagnose_and_fix_admin.sh > diagnostics.txt 2>&1

# –õ–æ–≥–∏ backend
sudo journalctl -u iiko-backend -n 100 > backend.log
# –ò–õ–ò –¥–ª—è Docker:
docker-compose logs backend --tail=100 > backend.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl -v -X POST http://localhost:8000/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"12101991Qq!"}' 2>&1 > api_test.log
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª—ã

- `diagnostics.txt` - —á—Ç–æ –Ω–∞—à–µ–ª —Å–∫—Ä–∏–ø—Ç
- `backend.log` - –ª–æ–≥–∏ backend —Å–µ—Ä–≤–∏—Å–∞
- `api_test.log` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞ API

### 3. –°–æ–∑–¥–∞–π—Ç–µ issue –Ω–∞ GitHub

–ü—Ä–∏–ª–æ–∂–∏—Ç–µ —ç—Ç–∏ —Ñ–∞–π–ª—ã –∏ –æ–ø–∏—à–∏—Ç–µ:
- –ß—Ç–æ –≤—ã –ø—Ä–æ–±–æ–≤–∞–ª–∏
- –ö–∞–∫–∏–µ –æ—à–∏–±–∫–∏ –≤–∏–¥–µ–ª–∏
- –í–∞—à–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (Docker/systemd, –û–°)

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π –°–ø–∏—Å–æ–∫ –ü–æ—Å–ª–µ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ –∏ –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É:

- [ ] –°–º–µ–Ω–∏–ª –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ –≤—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–æ–≤—ã–º –ø–∞—Ä–æ–ª–µ–º
- [ ] –ù–∞—Å—Ç—Ä–æ–∏–ª —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [ ] –î–æ–±–∞–≤–∏–ª –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞
- [ ] –ù–∞—Å—Ç—Ä–æ–∏–ª HTTPS (SSL/TLS) –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ CORS –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –î–æ–±–∞–≤–∏–ª –¥—Ä—É–≥–∏—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

---

## üéì –ß–µ–º—É –ú—ã –ù–∞—É—á–∏–ª–∏—Å—å

### –ì–ª–∞–≤–Ω—ã–µ –£—Ä–æ–∫–∏:
1. **–ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã** - –∫–æ–ª–æ–Ω–∫–∞ `role` –±—ã–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–∑–∂–µ
2. **–•–µ—à–∏ –ø–∞—Ä–æ–ª–µ–π —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã** - —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –ª–æ–º–∞—é—Ç –≤—Å—ë
3. **–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è** - –æ–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç –≤–º–µ—Å—Ç–æ 10 —Ä—É—á–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–∞** - –ø–∞—Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –ë—É–¥—É—â–µ–µ:
- –í—Å–µ–≥–¥–∞ –º–µ–Ω—è–π—Ç–µ –ø–∞—Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –†–µ–≥—É–ª—è—Ä–Ω–æ –¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø–∞—Ä–æ–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- –î–µ—Ä–∂–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∞–∫—Ç—É–∞–ª—å–Ω–æ–π

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- üìñ [–ü–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ](–ü–û–õ–ù–û–ï_–†–ï–®–ï–ù–ò–ï_–í–•–û–î–ê_–í_–ê–î–ú–ò–ù–ö–£.md)
- üöÄ [–ë—ã—Å—Ç—Ä–∞—è –ø–æ–º–æ—â—å](–ë–´–°–¢–†–ê–Ø_–ü–û–ú–û–©–¨_–í–•–û–î_–í_–ê–î–ú–ò–ù–ö–£.md)
- üåç [Quick Fix (EN)](ADMIN_LOGIN_QUICK_FIX.md)

**–ö–æ–º–∞–Ω–¥—ã:**
- `./scripts/diagnose_and_fix_admin.sh` - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- `./scripts/check_admin_db.sh` - –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã
- `./scripts/reset_admin_password.sh` - –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è

**GitHub:**
- Issues: https://github.com/dovezukatmn/iiko-base/issues

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!**

1. ‚úÖ –°–æ–∑–¥–∞–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç
2. ‚úÖ –í—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
3. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
4. ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∞
5. ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–µ–Ω–∞

**–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:**
```bash
./scripts/diagnose_and_fix_admin.sh
```

–ò —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –Ω–∞ —ç–∫—Ä–∞–Ω–µ!

---

**–ê–≤—Ç–æ—Ä:** dovezukatmn  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2026-02-09  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
